
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Admin Session 10</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #111; color: white; text-align: center; padding: 30px; }
        table { margin-top: 20px; }
        th, td { color: white; }
        .btn-warning { margin-top: 10px; }
    </style>
</head>
<body>
    <h2>🛠️ Panel Admin - Visitantes conectados</h2>
    <button class="btn btn-warning" onclick="limpiarVisitantes()">🧹 Limpiar Visitantes</button>
    <table class="table table-dark">
        <thead>
            <tr><th>Nombre</th><th>Estado</th><th>Acciones</th></tr>
        </thead>
        <tbody id="tablaVisitantes"></tbody>
    </table>

    <script>
        const firebaseConfig = {
            databaseURL: "https://karaokedatabase-c6a7d-default-rtdb.firebaseio.com"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function renderVisitantes(snapshot) {
            const tabla = document.getElementById("tablaVisitantes");
            tabla.innerHTML = "";
            const visitantes = snapshot.val();
            if (!visitantes) return;
            Object.entries(visitantes).forEach(([id, data]) => {
                const tr = document.createElement("tr");
                tr.innerHTML = `<td>${data.nombre || "(sin nombre)"}</td>
                                <td>${data.habilitado ? "Habilitado" : "Deshabilitado"}</td>
                                <td><button class='btn btn-sm btn-${data.habilitado ? "danger" : "success"}' onclick='toggle("${id}", ${!data.habilitado})'>
                                    ${data.habilitado ? "Deshabilitar" : "Habilitar"}
                                </button></td>`;
                tabla.appendChild(tr);
            });
        }

        db.ref("visitantes").on("value", renderVisitantes);

        function toggle(id, estado) {
            db.ref("visitantes/" + id).update({ habilitado: estado });
        }

        function limpiarVisitantes() {
            db.ref("visitantes").remove();
        }
    </script>
</body>
</html>
